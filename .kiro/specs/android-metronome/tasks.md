# 実装計画

- [x] 1. Androidプロジェクトのセットアップと基本構造の作成
  - Android Studioで新しいプロジェクトを作成（Compose Activity テンプレート使用）
  - 必要な依存関係をbuild.gradleに追加（Compose、ViewModel、Material3）
  - プロジェクト構造とパッケージを整理
  - _要件: 4.4_

- [x] 2. データモデルと状態管理の実装
  - [x] 2.1 MetronomeStateデータクラスの作成
    - BPM、再生状態、ビート間隔を管理するデータクラスを実装
    - BPM範囲検証とビート間隔計算ロジックを追加
    - _要件: 1.1, 1.2_
  
  - [x] 2.2 MetronomeViewModelの実装
    - StateFlowを使用した状態管理を実装
    - BPM設定、再生制御のメソッドを作成
    - _要件: 1.1, 1.4, 2.1, 2.2, 2.3_

- [x] 3. オーディオシステムの実装
  - [x] 3.1 AudioManagerクラスの作成
    - MediaPlayerを使用したビート音再生機能を実装
    - Handler + Runnableによる正確なタイミング制御を実装
    - _要件: 3.1, 3.3_
  
  - [x] 3.2 ビート音ファイルの追加と設定
    - assets/click.wavファイルを追加
    - MediaPlayerの初期化とエラーハンドリングを実装
    - _要件: 3.2_

- [x] 4. UIコンポーネントの実装
  - [x] 4.1 MetronomeScreenの基本レイアウト作成
    - Compose UIでBPM表示、スライダー、プレイボタンを配置
    - Material Design 3のテーマを適用
    - _要件: 4.1, 4.2_
  
  - [x] 4.2 BPM入力コントロールの実装
    - Sliderコンポーネントで40-300 BPMの範囲設定を実装
    - リアルタイムBPM表示を追加
    - _要件: 1.1, 1.3, 1.4_
  
  - [x] 4.3 プレイ/ストップボタンの実装
    - FloatingActionButtonで再生制御を実装
    - 再生状態に応じたアイコン切り替えを追加
    - _要件: 2.1, 2.2, 2.3, 2.4_

- [x] 5. ViewModelとUIの統合
  - [x] 5.1 状態バインディングの実装
    - ViewModelの状態をCompose UIにバインド
    - ユーザーインタラクションのイベントハンドリングを実装
    - _要件: 1.4, 2.1, 2.2, 2.3_
  
  - [x] 5.2 視覚的フィードバックの追加
    - ビートに合わせたアニメーション効果を実装
    - ボタン状態の視覚的インジケーターを追加
    - _要件: 2.4, 4.3_

- [x] 6. エラーハンドリングとライフサイクル管理
  - [x] 6.1 入力検証の実装
    - BPM範囲外値の処理を実装
    - 無効な状態遷移の防止を追加
    - _要件: 1.2_
  
  - [x] 6.2 ライフサイクル管理の実装
    - アプリのpause/resumeでのメトロノーム制御を実装
    - リソース解放処理を追加
    - _要件: 3.4_

- [x] 7. パフォーマンス最適化とポリッシュ
  - [x] 7.1 タイミング精度の最適化
    - SystemClock.uptimeMillis()を使用した高精度タイミングを実装
    - ビート間隔の動的調整機能を追加
    - _要件: 3.3_
  
  - [x] 7.2 アクセシビリティ対応
    - TalkBack対応とコンテンツ説明を追加
    - 大きなタッチターゲットサイズを確保
    - _要件: 4.2, 4.3_

- [x] 8. テストの実装
  - [x] 8.1 ViewModelの単体テスト作成
    - BPM計算ロジックのテストを作成
    - 状態遷移のテストを実装
    - _要件: 1.1, 1.2, 2.1, 2.2, 2.3_
  
  - [x] 8.2 Compose UIテストの作成
    - ユーザーインタラクションのテストを作成
    - アクセシビリティテストを実装
    - _要件: 4.1, 4.2, 4.3_